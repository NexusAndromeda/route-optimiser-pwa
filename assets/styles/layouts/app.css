/* ============================================
   APP LAYOUT - Estructura General de la App
   ============================================ */

/* Map Container - Full screen behind everything */
.map-container {
  position: fixed;
  top: var(--header-height);
  left: 0;
  right: 0;
  /* En móvil: dejar espacio para el bottom sheet - se actualiza dinámicamente con CSS variable */
  bottom: var(--bottom-sheet-height);
  width: 100%;
  height: calc(100vh - var(--header-height) - var(--bottom-sheet-height));
  z-index: 1;
  transition: bottom 0.3s ease, height 0.3s ease; /* Transición suave cuando cambia el bottom sheet */
}

.map-container canvas {
  outline: none;
}

/* Package Container - Contains bottom sheet */
.package-container {
  position: relative;
  z-index: 50;
}

/* Mapbox controls customization */
.mapboxgl-ctrl-group {
  background: var(--bg-surface) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
}

.mapboxgl-ctrl-group button {
  background-color: transparent !important;
  border: none !important;
}

.mapboxgl-ctrl-group button + button {
  border-top: 1px solid var(--border-color) !important;
}

.mapboxgl-ctrl-geolocate {
  background: var(--bg-surface) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
}

.mapboxgl-ctrl-geolocate button {
  background-color: transparent !important;
  border: none !important;
}

/* Icons of controls - need to invert in dark mode */
.mapboxgl-ctrl-icon {
  filter: brightness(0) invert(1);
}

@media (prefers-color-scheme: light) {
  .mapboxgl-ctrl-icon {
    filter: brightness(0);
  }
}

.mapboxgl-ctrl-group button:hover,
.mapboxgl-ctrl-geolocate button:hover {
  background-color: var(--bg-surface-variant) !important;
}

.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-active button {
  background-color: var(--color-primary) !important;
}

.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-active .mapboxgl-ctrl-icon {
  filter: brightness(0) invert(1);
}

/* Mapbox logo and attribution - Visible en todas las resoluciones */
/* El logo está dentro del área del mapa que tiene bottom: 80px en móvil, así que es visible */
.mapboxgl-ctrl-bottom-left,
.mapboxgl-ctrl-bottom-right {
  z-index: 10;
  pointer-events: none;
}

.mapboxgl-ctrl-bottom-left a,
.mapboxgl-ctrl-bottom-right a {
  pointer-events: auto;
}

/* ===== RESPONSIVE: DESKTOP ===== */
@media (min-width: 768px) {
  /* El mapa ocupa el resto del espacio */
  .map-container {
    left: var(--sidebar-width);
    /* En desktop no necesitamos bottom porque el sidebar está a la izquierda */
    bottom: 0;
    height: calc(100vh - var(--header-height));
  }
}
